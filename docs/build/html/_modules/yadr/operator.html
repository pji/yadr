<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>yadr.operator &mdash; yadr 0.1.2 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            yadr
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to yadrâ€™s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Public API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dice_notation.html">YADN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internals.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">yadr</span></code> Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../requirements.html">yadr Requirements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">yadr</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">yadr.operator</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for yadr.operator</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">operator</span>
<span class="sd">~~~~~~~~</span>

<span class="sd">Operators for handling the dice part of dice notation.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Sequence</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">operator</span>


<span class="c1"># Types for annotation.</span>
<span class="n">OptionsOp</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
<span class="n">ChoiceOp</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">PoolGenOp</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
<span class="n">DiceOp</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">MathOp</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">PoolOp</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
<span class="n">PoolDegenOp</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">UPoolDegenOp</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">Operation</span> <span class="o">=</span> <span class="n">Callable</span>


<span class="c1"># Registration.</span>
<span class="n">ops</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Operation</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;^&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">pow</span><span class="p">,</span>
    <span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span>
    <span class="s1">&#39;/&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">floordiv</span><span class="p">,</span>
    <span class="s1">&#39;%&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">mod</span><span class="p">,</span>
    <span class="s1">&#39;+&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span>
    <span class="s1">&#39;-&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span>
    <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span>
    <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">le</span><span class="p">,</span>
    <span class="s1">&#39;&gt;=&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">ge</span><span class="p">,</span>
    <span class="s1">&#39;&lt;=&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">le</span><span class="p">,</span>
    <span class="s1">&#39;==&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">eq</span><span class="p">,</span>
    <span class="s1">&#39;!=&#39;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">ne</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">class</span> <span class="nc">operation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A registration decorator for operations.</span>

<span class="sd">    :param symbol: The string used to refer to the operation.</span>
<span class="sd">    :return: None.</span>
<span class="sd">    :rtype: NoneType</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="n">symbol</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Operation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Operation</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register the operation.</span>

<span class="sd">        :param fn: The decorated function. It&#39;s sent automatically</span>
<span class="sd">            when :class:`operator.operation` is used as a decorator.</span>
<span class="sd">        :return: The decorated :class:`collections.abc.Callable`.</span>
<span class="sd">        :rtype: Callable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ops</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span>
        <span class="k">return</span> <span class="n">fn</span>


<span class="c1"># Choice operators.</span>
<div class="viewcode-block" id="choice_options"><a class="viewcode-back" href="../../operators.html#yadr.operator.choice_options">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">choice_options</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the options for a choice.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`choice_options`</span>

<span class="sd">    :param a: The qualifier for the true condition of a choice.</span>
<span class="sd">    :param b: The qualifier for the false condition of a choice.</span>
<span class="sd">    :return: The qualifiers as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; choice_options(&#39;success&#39;, &#39;failure&#39;)</span>
<span class="sd">        (&#39;success&#39;, &#39;failure&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="choice"><a class="viewcode-back" href="../../operators.html#yadr.operator.choice">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">choice</span><span class="p">(</span><span class="n">boolean</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a choice.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`choice`</span>

<span class="sd">    :param boolean: The decision as a :class:`bool`.</span>
<span class="sd">    :param options: The two options to pick from.</span>
<span class="sd">    :return: The chosen option as a :class:`str`.</span>
<span class="sd">    :rtype: str</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; choice(False, (&#39;spam&#39;, &#39;eggs&#39;))</span>
<span class="sd">        &#39;eggs&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">boolean</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span></div>


<span class="c1"># Dice operators.</span>
<div class="viewcode-block" id="concat"><a class="viewcode-back" href="../../operators.html#yadr.operator.concat">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;dc&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Concatenate the least significant digits.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`concat`</span>

<span class="sd">    :param num: The number of dice to roll.</span>
<span class="sd">    :param size: The highest number that can be rolled on a die.</span>
<span class="sd">    :return: The concatenated least significant digits as an</span>
<span class="sd">        :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # This line is to ensure predictability for testing.</span>
<span class="sd">        &gt;&gt;&gt; # Do not use outside of test cases.</span>
<span class="sd">        &gt;&gt;&gt; _seed(&#39;spam&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Roll 2d10 as percentile dice. It&#39;s not quite right,</span>
<span class="sd">        &gt;&gt;&gt; # since 00 should be 100, but the physical dice have</span>
<span class="sd">        &gt;&gt;&gt; # that problem, too.</span>
<span class="sd">        &gt;&gt;&gt; concat(2, 10)</span>
<span class="sd">        21</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">dice_pool</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">pool_modulo</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pool_concatenate</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="die"><a class="viewcode-back" href="../../operators.html#yadr.operator.die">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">die</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Roll a number of same-sized dice and return the result.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`die`</span>

<span class="sd">    :param num: The number of dice to roll.</span>
<span class="sd">    :param size: The highest number that can be rolled on a die.</span>
<span class="sd">    :return: The sum of the result of each die as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # This line is to ensure predictability for testing.</span>
<span class="sd">        &gt;&gt;&gt; # Do not use outside of test cases.</span>
<span class="sd">        &gt;&gt;&gt; _seed(&#39;spam&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Roll 3d6.</span>
<span class="sd">        &gt;&gt;&gt; die(3, 6)</span>
<span class="sd">        5</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">dice_pool</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="exploding_die"><a class="viewcode-back" href="../../operators.html#yadr.operator.exploding_die">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;d!&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">exploding_die</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Roll a number of exploding same-sized dice.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`explode`</span>

<span class="sd">    :param num: The number of dice to roll.</span>
<span class="sd">    :param size: The highest number that can be rolled on a die.</span>
<span class="sd">    :return: The sum of the result of each die as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # This line is to ensure predictability for testing.</span>
<span class="sd">        &gt;&gt;&gt; # Do not use outside of test cases.</span>
<span class="sd">        &gt;&gt;&gt; _seed(&#39;spam&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Roll 5d!6.</span>
<span class="sd">        &gt;&gt;&gt; exploding_die(5, 6)</span>
<span class="sd">        15</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">exploding_pool</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span></div>


<div class="viewcode-block" id="keep_high_die"><a class="viewcode-back" href="../../operators.html#yadr.operator.keep_high_die">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;dh&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">keep_high_die</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Roll a number of dice and keep the highest.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`keep_high`</span>

<span class="sd">    :param num: The number of dice to roll.</span>
<span class="sd">    :param size: The highest number that can be rolled on a die.</span>
<span class="sd">    :return: The highest value as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # This line is to ensure predictability for testing.</span>
<span class="sd">        &gt;&gt;&gt; # Do not use outside of test cases.</span>
<span class="sd">        &gt;&gt;&gt; _seed(&#39;spam&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Roll 5dh6.</span>
<span class="sd">        &gt;&gt;&gt; keep_high_die(5, 6)</span>
<span class="sd">        5</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">dice_pool</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="keep_low_die"><a class="viewcode-back" href="../../operators.html#yadr.operator.keep_low_die">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;dl&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">keep_low_die</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Roll a number of dice and keep the lowest.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`keep_low`</span>

<span class="sd">    :param num: The number of dice to roll.</span>
<span class="sd">    :param size: The highest number that can be rolled on a die.</span>
<span class="sd">    :return: The lowest value as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # This line is to ensure predictability for testing.</span>
<span class="sd">        &gt;&gt;&gt; # Do not use outside of test cases.</span>
<span class="sd">        &gt;&gt;&gt; _seed(&#39;spam&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Roll 5dh6.</span>
<span class="sd">        &gt;&gt;&gt; keep_low_die(5, 6)</span>
<span class="sd">        1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">dice_pool</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="wild_die"><a class="viewcode-back" href="../../operators.html#yadr.operator.wild_die">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;dw&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wild_die</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Roll a number of same-sized dice and return the result, with</span>
<span class="sd">    one of the dice being the wild die.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`wild_die`</span>

<span class="sd">    :param num: The number of dice to roll.</span>
<span class="sd">    :param size: The highest number that can be rolled on a die.</span>
<span class="sd">    :return: The sum of the values as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # This line is to ensure predictability for testing.</span>
<span class="sd">        &gt;&gt;&gt; # Do not use outside of test cases.</span>
<span class="sd">        &gt;&gt;&gt; _seed(&#39;spam&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Roll 5dw6.</span>
<span class="sd">        &gt;&gt;&gt; wild_die(5, 6)</span>
<span class="sd">        0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wild</span> <span class="o">=</span> <span class="n">exploding_pool</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">regular</span> <span class="o">=</span> <span class="n">dice_pool</span><span class="p">(</span><span class="n">num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">wild</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">wild</span><span class="p">),</span> <span class="nb">sum</span><span class="p">(</span><span class="n">regular</span><span class="p">)))</span></div>


<span class="c1"># Pool operators.</span>
<div class="viewcode-block" id="pool_cap"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_cap">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;pc&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_cap</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">cap</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cap the maximum value in a pool.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_cap`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param cap: The maximum value of a die roll.</span>
<span class="sd">    :return: The resulting values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]pc6.</span>
<span class="sd">        &gt;&gt;&gt; pool_cap([4, 10, 3, 5, 1, 9], 6)</span>
<span class="sd">        (4, 6, 3, 5, 1, 6)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">cap</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">cap</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="pool_floor"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_floor">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;pf&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_floor</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">floor</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Floor the minimum value in a pool.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_floor`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param floor: The minimum value of a die roll.</span>
<span class="sd">    :return: The resulting values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]pf6.</span>
<span class="sd">        &gt;&gt;&gt; pool_floor([4, 10, 3, 5, 1, 9], 6)</span>
<span class="sd">        (6, 10, 6, 6, 6, 9)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">floor</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">floor</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="pool_keep_above"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_keep_above">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;pa&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_keep_above</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">floor</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Discard all values in a pool below a given value.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_keep_above`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param floor: The minimum value to keep.</span>
<span class="sd">    :return: The resulting values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]pa6.</span>
<span class="sd">        &gt;&gt;&gt; pool_keep_above([4, 10, 3, 5, 1, 9], 6)</span>
<span class="sd">        (10, 9)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">pool</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="n">floor</span><span class="p">)</span></div>


<div class="viewcode-block" id="pool_keep_below"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_keep_below">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;pb&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_keep_below</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">ceiling</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Discard all values in a pool above a given value.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_keep_below`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param ceiling: The maximum value to keep.</span>
<span class="sd">    :return: The resulting values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]pb6.</span>
<span class="sd">        &gt;&gt;&gt; pool_keep_below([4, 10, 3, 5, 1, 9], 6)</span>
<span class="sd">        (4, 3, 5, 1)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">pool</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="n">ceiling</span><span class="p">)</span></div>


<div class="viewcode-block" id="pool_keep_high"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_keep_high">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;ph&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_keep_high</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">keep</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Keep a number of the highest dice.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_keep_high`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param keep: The maximum value to keep.</span>
<span class="sd">    :return: The resulting values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]ph3.</span>
<span class="sd">        &gt;&gt;&gt; pool_keep_high([4, 10, 3, 5, 1, 9], 3)</span>
<span class="sd">        (10, 5, 9)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span>
    <span class="n">remove</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span> <span class="o">-</span> <span class="n">keep</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">remove</span><span class="p">):</span>
        <span class="n">low_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span>
        <span class="n">low_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pool</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">low_value</span><span class="p">:</span>
                <span class="n">low_value</span> <span class="o">=</span> <span class="n">n</span>
                <span class="n">low_index</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">low_index</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="pool_keep_low"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_keep_low">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;pl&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_keep_low</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">keep</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Keep a number of the lowest dice.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_keep_low`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param keep: The maximum value to keep.</span>
<span class="sd">    :return: The resulting values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]pl3.</span>
<span class="sd">        &gt;&gt;&gt; pool_keep_low([4, 10, 3, 5, 1, 9], 3)</span>
<span class="sd">        (4, 3, 1)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span>
    <span class="n">remove</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span> <span class="o">-</span> <span class="n">keep</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">remove</span><span class="p">):</span>
        <span class="n">high_value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span>
        <span class="n">high_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pool</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">high_value</span><span class="p">:</span>
                <span class="n">high_value</span> <span class="o">=</span> <span class="n">n</span>
                <span class="n">high_index</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">high_index</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="pool_modulo"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_modulo">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;p%&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_modulo</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">divisor</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a modulo operation of each member.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_mod`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param divisor: The maximum value to keep.</span>
<span class="sd">    :return: The resulting values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]p%3.</span>
<span class="sd">        &gt;&gt;&gt; pool_modulo([4, 10, 3, 5, 1, 9], 3)</span>
<span class="sd">        (1, 1, 0, 2, 1, 0)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">divisor</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="pool_remove"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_remove">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;pr&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_remove</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">cut</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove members of a pool of the given value.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_remove`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param cut: The maximum value to keep.</span>
<span class="sd">    :return: The resulting values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]pr5.</span>
<span class="sd">        &gt;&gt;&gt; pool_remove([4, 10, 3, 5, 1, 9], 5)</span>
<span class="sd">        (4, 10, 3, 1, 9)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">pool</span> <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">cut</span><span class="p">)</span></div>


<span class="c1"># Pool degeneration operators.</span>
<div class="viewcode-block" id="pool_concatenate"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_concatenate">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_concatenate</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Concatenate the dice in the pool.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_concat`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :return: The resulting value as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll C[4, 10, 3, 5, 1, 9].</span>
<span class="sd">        &gt;&gt;&gt; pool_concatenate([4, 10, 3, 5, 1, 9])</span>
<span class="sd">        4103519</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">str_value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_value</span><span class="p">)</span></div>


<div class="viewcode-block" id="pool_count"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_count">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_count</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Count the dice in the pool.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_count`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :return: The resulting value as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll N[4, 10, 3, 5, 1, 9].</span>
<span class="sd">        &gt;&gt;&gt; pool_count([4, 10, 3, 5, 1, 9])</span>
<span class="sd">        6</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="pool_sum"><a class="viewcode-back" href="../../operators.html#yadr.operator.pool_sum">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pool_sum</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sum the dice in the pool.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`pool_sum`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :return: The resulting value as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll S[4, 10, 3, 5, 1, 9].</span>
<span class="sd">        &gt;&gt;&gt; pool_sum([4, 10, 3, 5, 1, 9])</span>
<span class="sd">        32</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="count_successes"><a class="viewcode-back" href="../../operators.html#yadr.operator.count_successes">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">count_successes</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">target</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Count the number of successes in the pool.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`count_successes`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param target: The target number for success.</span>
<span class="sd">    :return: The resulting value as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]ns6.</span>
<span class="sd">        &gt;&gt;&gt; count_successes([4, 10, 3, 5, 1, 9], 6)</span>
<span class="sd">        2</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">pool_keep_above</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<div class="viewcode-block" id="count_successes_with_botch"><a class="viewcode-back" href="../../operators.html#yadr.operator.count_successes_with_botch">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;nb&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">count_successes_with_botch</span><span class="p">(</span><span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">target</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Count the number of successes in the pool. Then remove a success</span>
<span class="sd">    for each botch.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`count_botch`</span>

<span class="sd">    :param pool: A sequence of die values.</span>
<span class="sd">    :param target: The target number for success.</span>
<span class="sd">    :return: The resulting value as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # Roll [4, 10, 3, 5, 1, 9]nb6.</span>
<span class="sd">        &gt;&gt;&gt; count_successes_with_botch([4, 10, 3, 5, 1, 9], 6)</span>
<span class="sd">        1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">botches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">pool</span> <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">pool_keep_above</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span> <span class="o">-</span> <span class="n">botches</span></div>


<span class="c1"># Pool generation operator.</span>
<div class="viewcode-block" id="dice_pool"><a class="viewcode-back" href="../../operators.html#yadr.operator.dice_pool">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">dice_pool</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Roll a dice pool.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`dice_pool`</span>

<span class="sd">    :param num: The number of dice to roll.</span>
<span class="sd">    :param size: The highest number that can be rolled on a die.</span>
<span class="sd">    :return: The the values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # This line is to ensure predictability for testing.</span>
<span class="sd">        &gt;&gt;&gt; # Do not use outside of test cases.</span>
<span class="sd">        &gt;&gt;&gt; _seed(&#39;spam&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Roll 5g6.</span>
<span class="sd">        &gt;&gt;&gt; dice_pool(5, 6)</span>
<span class="sd">        (1, 1, 3, 5, 5)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">))</span></div>


<div class="viewcode-block" id="exploding_pool"><a class="viewcode-back" href="../../operators.html#yadr.operator.exploding_pool">[docs]</a><span class="nd">@operation</span><span class="p">(</span><span class="s1">&#39;g!&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">exploding_pool</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Roll an exploding dice pool.</span>

<span class="sd">    :ref:`YADN` reference: :ref:`exploding_pool`</span>

<span class="sd">    :param num: The number of dice to roll.</span>
<span class="sd">    :param size: The highest number that can be rolled on a die.</span>
<span class="sd">    :return: The the values as a :class:`tuple`.</span>
<span class="sd">    :rtype: tuple</span>

<span class="sd">    Usage::</span>

<span class="sd">        &gt;&gt;&gt; # This line is to ensure predictability for testing.</span>
<span class="sd">        &gt;&gt;&gt; # Do not use outside of test cases.</span>
<span class="sd">        &gt;&gt;&gt; _seed(&#39;spam&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Roll 5g!6.</span>
<span class="sd">        &gt;&gt;&gt; exploding_pool(5, 6)</span>
<span class="sd">        (1, 1, 3, 5, 5)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pool</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">dice_pool</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">_explode</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span></div>


<span class="c1"># Utility functions.</span>
<span class="k">def</span> <span class="nf">_explode</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Explode the value of a die.</span>

<span class="sd">    :param num: The number of dice to roll.</span>
<span class="sd">    :param size: The highest number that can be rolled on a die.</span>
<span class="sd">    :return: The the values as an :class:`int`.</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">size</span><span class="p">:</span>
        <span class="n">explode_value</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">+=</span> <span class="n">_explode</span><span class="p">(</span><span class="n">explode_value</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>


<span class="k">def</span> <span class="nf">_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Seed the random number generator for testing purposes.</span>

<span class="sd">    :param seed: A seed value for the random number generator.</span>
<span class="sd">    :return: None.</span>
<span class="sd">    :rtype: NoneType</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">seed</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf_8&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="n">seed</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Paul J. Iutzi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>